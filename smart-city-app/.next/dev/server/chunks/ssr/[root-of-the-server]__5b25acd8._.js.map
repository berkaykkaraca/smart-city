{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/smart-city/smart-city-app/src/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { FormEvent, useEffect, useState } from \"react\";\n\n// Yeni Model Yapısına Uygun Tip Tanımlaması\ntype TrafficEvent = {\n  id: number;\n  average_kmh: number;\n  known_reason: string | null;\n  expected_resolution_time: string | null;\n  created_at: string;\n  // Serializer'dan gelen detay bilgisi\n  signaller_detail: {\n    city: string;\n    district: string;\n    road: string;\n  };\n};\n\nexport default function Home() {\n  const [events, setEvents] = useState<TrafficEvent[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [creating, setCreating] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Form State'leri\n  const [city, setCity] = useState(\"Istanbul\");\n  const [district, setDistrict] = useState(\"Kadikoy\");\n  const [roadName, setRoadName] = useState(\"Bagdat Caddesi\");\n  const [avgSpeed, setAvgSpeed] = useState(30);\n  const [reason, setReason] = useState(\"Heavy Traffic\");\n\n  async function fetchEvents() {\n    try {\n      setLoading(true);\n      setError(null);\n      const res = await fetch(\"/api/traffic\", { cache: \"no-store\" });\n      if (!res.ok) throw new Error(\"Failed to load events\");\n      const data = await res.json();\n      setEvents(data);\n    } catch (err: any) {\n      setError(err.message || \"Unknown error\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    fetchEvents();\n  }, []);\n\n  async function handleSubmit(e: FormEvent) {\n    e.preventDefault();\n    try {\n      setCreating(true);\n      setError(null);\n      \n      // Backend'in beklediği yeni JSON formatı\n      const payload = {\n        city_name: city,\n        district_name: district,\n        road_name: roadName,\n        average_kmh: avgSpeed,\n        known_reason: reason,\n      };\n\n      const res = await fetch(\"/api/traffic\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(payload),\n      });\n\n      if (!res.ok) {\n        const data = await res.json().catch(() => ({}));\n        throw new Error(data.detail || \"Failed to create event\");\n      }\n      await fetchEvents();\n    } catch (err: any) {\n      setError(err.message || \"Unknown error\");\n    } finally {\n      setCreating(false);\n    }\n  }\n\n  return (\n      <div className=\"min-h-screen bg-slate-950 text-slate-50 font-sans\"> \n        <main className=\"mx-auto flex max-w-6xl flex-col gap-8 px-6 py-12\">\n          <header className=\"flex flex-col gap-3 border-b border-slate-800 pb-6\">\n          <h1 className=\"text-4xl font-bold tracking-tight text-sky-400\">\n            Smart City Control Center\n          </h1>\n          <p className=\"max-w-3xl text-slate-400 text-lg\">\n            Manage city traffic incidents via relational data layers.\n            <br />\n            <span className=\"text-sm text-slate-500\">\n              Architecture: Next.js → Django API → Pub/Sub → Worker → PostgreSQL\n            </span>\n          </p>\n        </header>\n\n        <section className=\"grid gap-10 lg:grid-cols-[1fr_1.5fr]\">\n          {/* FORM ALANI */}\n          <div className=\"h-fit rounded-2xl border border-slate-800 bg-slate-900/50 p-6 shadow-xl backdrop-blur-sm\">\n            <h2 className=\"mb-6 text-xl font-semibold text-slate-200\">\n              Report Traffic Incident\n            </h2>\n            <form onSubmit={handleSubmit} className=\"space-y-5\">\n              \n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-xs font-medium uppercase text-slate-500\">City</label>\n                  <input\n                    className=\"w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2.5 text-slate-200 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 transition-all outline-none\"\n                    value={city}\n                    onChange={(e) => setCity(e.target.value)}\n                    placeholder=\"e.g. Istanbul\"\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-xs font-medium uppercase text-slate-500\">District</label>\n                  <input\n                    className=\"w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2.5 text-slate-200 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 transition-all outline-none\"\n                    value={district}\n                    onChange={(e) => setDistrict(e.target.value)}\n                    placeholder=\"e.g. Kadikoy\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-1.5\">\n                <label className=\"text-xs font-medium uppercase text-slate-500\">Road / Signaller Name</label>\n                <input\n                  className=\"w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2.5 text-slate-200 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 transition-all outline-none\"\n                  value={roadName}\n                  onChange={(e) => setRoadName(e.target.value)}\n                  placeholder=\"e.g. Bagdat Street Sensor #4\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-xs font-medium uppercase text-slate-500\">Speed (km/h)</label>\n                  <input\n                    type=\"number\"\n                    className=\"w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2.5 text-slate-200 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 transition-all outline-none\"\n                    value={avgSpeed}\n                    onChange={(e) => setAvgSpeed(Number(e.target.value))}\n                  />\n                </div>\n                <div className=\"space-y-1.5\">\n                  <label className=\"text-xs font-medium uppercase text-slate-500\">Known Reason</label>\n                  <input\n                    className=\"w-full rounded-lg border border-slate-700 bg-slate-800 px-3 py-2.5 text-slate-200 focus:border-sky-500 focus:ring-1 focus:ring-sky-500 transition-all outline-none\"\n                    value={reason}\n                    onChange={(e) => setReason(e.target.value)}\n                    placeholder=\"e.g. Accident\"\n                  />\n                </div>\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={creating}\n                className=\"w-full rounded-lg bg-sky-600 py-3 font-semibold text-white shadow-lg hover:bg-sky-500 disabled:opacity-50 transition-colors\"\n              >\n                {creating ? \"Publishing Event...\" : \"Create & Publish Event\"}\n              </button>\n              {error && <p className=\"text-center text-sm text-red-400\">{error}</p>}\n            </form>\n          </div>\n\n          {/* LISTE ALANI */}\n          <div className=\"flex flex-col gap-4\">\n            <div className=\"flex items-center justify-between\">\n              <h2 className=\"text-xl font-semibold text-slate-200\">Live Traffic Feed</h2>\n              <button onClick={fetchEvents} className=\"text-sm text-sky-400 hover:underline\">\n                Refresh Data\n              </button>\n            </div>\n            \n            {loading ? (\n              <div className=\"text-slate-500\">Loading stream...</div>\n            ) : events.length === 0 ? (\n              <div className=\"rounded-xl border border-slate-800 bg-slate-900/30 p-8 text-center text-slate-500\">\n                No active traffic events recorded.\n              </div>\n            ) : (\n              <ul className=\"space-y-3\">\n                {events.map((ev) => (\n                  <li key={ev.id} className=\"group relative overflow-hidden rounded-xl border border-slate-800 bg-slate-900 p-5 transition-all hover:border-slate-700 hover:bg-slate-800/80\">\n                    <div className=\"flex justify-between items-start\">\n                      <div className=\"space-y-1\">\n                        <div className=\"flex items-center gap-2\">\n                            <span className=\"bg-sky-500/10 text-sky-400 px-2 py-0.5 rounded text-xs font-bold uppercase tracking-wider\">\n                                {ev.signaller_detail.city}\n                            </span>\n                            <span className=\"text-slate-500 text-xs\">/</span>\n                            <span className=\"text-slate-300 text-sm font-medium\">\n                                {ev.signaller_detail.district}\n                            </span>\n                        </div>\n                        <h3 className=\"text-lg font-semibold text-white\">\n                          {ev.signaller_detail.road}\n                        </h3>\n                        {ev.known_reason && (\n                           <p className=\"text-sm text-amber-400\">⚠️ {ev.known_reason}</p>\n                        )}\n                        <p className=\"text-xs text-slate-500 pt-2\">\n                           Event ID: #{ev.id} • {new Date(ev.created_at).toLocaleString()}\n                        </p>\n                      </div>\n\n                      <div className=\"text-right\">\n                        <div className=\"text-3xl font-bold text-white\">\n                            {ev.average_kmh} <span className=\"text-sm text-slate-500 font-normal\">km/h</span>\n                        </div>\n                        <div className=\"mt-1 text-xs text-slate-400\">Avg Speed</div>\n                      </div>\n                    </div>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div>\n        </section>\n      </main>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 530, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/smart-city/smart-city-app/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 549, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/smart-city/smart-city-app/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,8JACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 554, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/User/Desktop/smart-city/smart-city-app/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,8JACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}